<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>장바구니</title>
    <style>
        .product-image {
            width: 100px;
            height: 100px;
        }
    </style>
</head>
<body>
<h1>장바구니</h1>

<table border="1">
    <thead>
    <tr>
        <th>상품 이미지</th>
        <th>상품 이름</th>
        <th>수량</th>
        <th>가격</th>
        <th>합계</th>
        <th>삭제</th>
    </tr>
    </thead>
    <tbody>
    <!-- 여기에 타임리프 루프를 사용하여 장바구니 항목을 출력합니다. -->
    <tr th:each="cartItem : ${cartItems}">
        <td><img th:src="|/item/images/${cartItem.item.storeFileName}|" alt="상품 이미지" class="product-image"></td>
        <td th:text="${cartItem.item.name}"></td>
        <td>
            <button onclick="updateQuantity(${cartItemIndex.index}, -1)">-</button>
            <span th:text="${cartItem.quantity}"></span>
            <button onclick="updateQuantity(${cartItemIndex.index}, 1)">+</button>
        </td>
        <td th:text="${cartItem.quantity * cartItem.item.price}"></td>
        <td><button onclick="removeItem(${cartItemIndex.index})">X</button></td>
    </tr>
    </tbody>
</table>

<p>총 구매 금액: <span th:text="${totalPrice}"></span></p>
<button>구매하기</button>

<script>
        function updateQuantity(index, change) {
            var quantityElement = document.querySelector('tbody').getElementsByTagName('tr')[index].getElementsByTagName('td')[2].getElementsByTagName('span')[0];
            var newQuantity = parseInt(quantityElement.textContent) + change;
            if (newQuantity > 0) {
                quantityElement.textContent = newQuantity;
                // 여기에 수량 변경에 따른 가격 업데이트 로직 추가 가능
            }
        }

        function removeItem(index) {
            var rowToRemove = document.querySelector('tbody').getElementsByTagName('tr')[index];
            rowToRemove.remove();
            // 여기에 장바구니에서 상품 제거 후 총 구매 금액 업데이트 로직 추가 가능
        }
    </script>
</body>
</html>
